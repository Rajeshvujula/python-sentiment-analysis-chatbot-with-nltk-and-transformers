# Sentiment Analysis of Amazon Reviews using NLTK & Transformers

This project performs sentiment analysis on Amazon product reviews using two distinct natural language processing (NLP) techniques: NLTK's VADER, a rule-based sentiment analyzer, and RoBERTa, a state-of-the-art pre-trained model from the Hugging Face Transformers library. The goal is to explore, analyze, and compare the sentiment scores generated by these models against the original star ratings of the reviews.

## üìú Project Overview

The notebook walks through the entire process of a typical NLP project:

1.  **Data Loading and Exploration**: Loading the Amazon Reviews dataset and performing initial exploratory data analysis (EDA) to understand the distribution of review scores.
2.  **Basic NLP with NLTK**: Demonstrating fundamental NLP tasks like tokenization, part-of-speech tagging, and named entity recognition on a sample review.
3.  **VADER Sentiment Scoring**: Applying the Valence Aware Dictionary and sEntiment Reasoner (VADER) to calculate polarity scores (positive, negative, neutral, and compound) for each review.
4.  **RoBERTa Pre-trained Model**: Utilizing a powerful, pre-trained RoBERTa model fine-tuned for sentiment analysis to predict sentiment on the same reviews.
5.  **Comparative Analysis**: Comparing the results from both VADER and RoBERTa models against the actual star ratings to evaluate their performance and nuances.

## üìä Dataset

This project uses the **Amazon Fine Food Reviews** dataset, which is publicly available on Kaggle. For demonstration purposes, this notebook processes the first 500 reviews from the `Reviews.csv` file. The dataset contains product reviews, user information, and the corresponding star rating (Score).

## üõ†Ô∏è Technologies & Libraries Used

  * **Python 3**
  * **Jupyter Notebook**
  * **Core Libraries**:
      * `pandas`: For data manipulation and analysis.
      * `numpy`: For numerical operations.
      * `matplotlib` & `seaborn`: For data visualization.
      * `tqdm`: For displaying progress bars.
  * **NLP Libraries**:
      * `nltk`: For basic NLP tasks and VADER sentiment analysis.
      * `transformers` (Hugging Face): For using the pre-trained RoBERTa model.
      * `scipy`: For the softmax function to normalize model outputs.

## üöÄ Methodology

### 1\. Exploratory Data Analysis (EDA)

The first step was to visualize the distribution of review scores (1 to 5 stars) to understand the dataset's balance.

```python
ax = df['Score'].value_counts().sort_index()\\
    .plot(kind = 'bar',
          title='count of Reviews by Stars',
          figsize=(10,5))
ax.set_xlabel('Review Stars')
plt.show()
```

### 2\. NLTK's VADER Sentiment Analysis

A rule-based sentiment analyzer, VADER, was used to quickly generate sentiment scores. It provides four scores:

  * `neg`: Negative sentiment score
  * `neu`: Neutral sentiment score
  * `pos`: Positive sentiment score
  * `compound`: A normalized, weighted composite score.

<!-- end list -->

```python
from nltk.sentiment import SentimentIntensityAnalyzer

sia = SentimentIntensityAnalyzer()
res = {}
for i, row in tqdm(df.iterrows(), total=len(df)):
    text = row['Text']
    myid = row['Id']
    res[myid] = sia.polarity_scores(text)
```

The compound score was then plotted against the actual star rating, showing a clear positive correlation.

### 3\. Transformer-based Sentiment Analysis (RoBERTa)

For a more advanced analysis, the pre-trained `cardiffnlp/twitter-roberta-base-sentiment` model from Hugging Face was employed. This model is fine-tuned on a massive dataset of tweets and provides a more nuanced understanding of language.

```python
from transformers import AutoTokenizer, AutoModelForSequenceClassification
from scipy.special import softmax

MODEL = f"cardiffnlp/twitter-roberta-base-sentiment"
tokenizer = AutoTokenizer.from_pretrained(MODEL)
model = AutoModelForSequenceClassification.from_pretrained(MODEL)

def polarity_scores_roberta(example):
    # ... function to process text and return scores ...
    return scores_dict
```

The model outputs scores for negative, neutral, and positive sentiments, which were then compared with the VADER scores and the original ratings.

## üìà Results & Comparison

The project culminates in a comparative analysis of the two models. A pair plot was generated to visualize the relationships between the VADER scores, RoBERTa scores, and the actual Amazon review `Score`.

### Key Observations:

  * **VADER** provides a good baseline and shows a strong correlation between its compound score and the star rating. However, it can sometimes be misled by complex sentences.
  * **RoBERTa** demonstrates a more sophisticated understanding of sentiment, often capturing nuances that VADER misses. For example, it correctly identified strong negative sentiment in sarcastic or complex negative reviews that VADER might have scored as neutral or slightly negative.
  * For 5-star reviews, both models generally perform well in identifying positive sentiment, although RoBERTa occasionally detects negative undertones in otherwise positive reviews (e.g., "this was sooooo delicious but too bad I gained 2 pds\!").

## ‚öôÔ∏è How to Run this Project

To run this notebook on your local machine, follow these steps:

1.  **Clone the repository:**

    ```bash
    git clone https://github.com/your-username/sentiment-analysis-amazon-reviews.git
    cd sentiment-analysis-amazon-reviews
    ```

2.  **Set up a virtual environment (recommended):**

    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows, use `venv\Scripts\activate`
    ```

3.  **Install the required libraries:**
    Create a `requirements.txt` file with the following content:

    ```
    pandas
    numpy
    matplotlib
    seaborn
    nltk
    tqdm
    transformers
    scipy
    torch
    tensorflow
    ```

    Then run:

    ```bash
    pip install -r requirements.txt
    ```

    *You will also need to download the NLTK resources. Run the following in a Python interpreter:*

    ```python
    import nltk
    nltk.download('punkt')
    nltk.download('vader_lexicon')
    nltk.download('averaged_perceptron_tagger')
    nltk.download('maxent_ne_chunker')
    nltk.download('words')
    ```

4.  **Download the Dataset:**

      * Download the `Reviews.csv` file from the [Amazon Fine Food Reviews dataset on Kaggle](https://www.kaggle.com/datasets/snap/amazon-fine-food-reviews).
      * Place the `Reviews.csv` file in the root directory of the project.

5.  **Launch Jupyter Notebook:**

    ```bash
    jupyter notebook
    ```

    Then, open the `python sentiment analysis chatbot with nltk and transformers.ipynb` file.

## üîö Conclusion

This project successfully demonstrates and compares a classic rule-based NLP technique with a modern, Transformer-based approach for sentiment analysis. While VADER is fast and effective for simple texts, the RoBERTa model provides a deeper, more accurate understanding of sentiment, highlighting the power of pre-trained language models in modern NLP.
